# 投篮系统自动标定工具配置文件

# 点云数据源配置
data_source:
  mode: "offline"  # 数据采集模式: "offline"=离线点云文件, "realtime"=实时相机采集
  # mode: "realtime"  # 数据采集模式: "offline"=离线点云文件, "realtime"=实时相机采集

  # 离线模式配置
  offline:
    input_file: "data/1222/DepthPoints_3546026307.ply"

  # 实时采集模式配置
  realtime:
    # 相机参数
    camera:
      type: "orbbec"  # 相机类型:"orbbec"
      serial_number: ""  # 相机序列号(为空则使用第一个可用相机)

      # 采集参数
      resolution:
        width: 1280
        height: 720
      frame_rate: 30  # 帧率(fps)
      depth_range: [0.3, 10.0]  # 深度范围(米): [最小距离, 最大距离]

    # 多帧融合配置
    multi_frame_fusion:
      enabled: true  # 是否启用多帧融合
      num_frames: 10  # 融合帧数
      fusion_method: "average"  # 融合方法: "average"=平均, "median"=中值

    # 点云质量检测
    quality_check:
      enabled: true  # 是否启用质量检测
      min_points: 50000  # 最小点数要求
      coverage_check: true  # 是否检查覆盖范围
      max_retries: 1  # 质量不达标时最大重试次数

# 输出配置
output:
  dir: "output"  # 输出目录
  config_file: "config.json"  # 输出的转换矩阵配置文件
  save_intermediate: true  # 是否保存中间结果
  save_raw_pointcloud: true  # 是否保存原始采集的点云

# 点云预处理参数
preprocessing:
  # 降采样参数 - 体素网格滤波
  downsample:
    voxel_size: 0.03  # 体素大小（米）- 增加到30mm以确保有效降采样

  # 噪声滤波参数 - 统计离群值移除
  noise_filter:
    nb_neighbors: 50  # 每个点分析的近邻点数
    std_ratio: 1.0    # 距离阈值（倍标准差）

  # 点云聚类参数 - 欧几里得聚类
  clustering:
    eps: 0.1          # 聚类距离阈值（米）
    min_points: 10    # 最小点数（形成一个簇所需的最小点数）
    max_points: 100000 # 最大点数（单个簇的最大点数）

# 地面检测参数 - RANSAC平面检测（注意：点云单位为毫米）
ground_detection:
  distance_threshold: 10       # RANSAC距离阈值（毫米）- 严格限制只选择真正的地面点
  ransac_n: 3                  # RANSAC最小点数（拟合平面所需）
  num_iterations: 10000        # RANSAC最大迭代次数
  random_seed: 42              # 随机数种子（保证结果可复现）

  # 噪声过滤参数
  noise_filter:
    distance_threshold: 10     # 点到平面距离阈值（毫米）- 同步减小
    nb_neighbors: 20           # 统计离群值检测的邻域点数
    std_ratio: 2.0             # 统计离群值检测的标准差倍数

# 篮筐检测参数
hoop_detection:
  standard_diameter: 0.45   # 标准篮筐直径（米）
  height_range: [2.9, 3.2]  # 篮筐高度范围（米）
  diameter_tolerance: 0.025  # 直径容差（米），±50mm
  random_seed: 42           # 随机数种子（保证结果可复现）

# 可视化参数
visualization:
  enabled: false            # 是否启用可视化窗口（true=启用，false=禁用）
  point_size: 2.0          # 点云显示大小
